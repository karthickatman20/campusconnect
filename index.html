<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Campus Connect - Home</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="maincss.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
  /* Make all card images the same height and nicely fitted */
.card img {
  width: 100%;
  height: 250px; /* adjust as needed */
  object-fit: cover;
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

/* Ensure all cards have equal height */
.card {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

/* Keep button section aligned at the bottom */
.card-body {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
}

/* Center the button consistently */
.card-body button {
  align-self: center;
  margin-top: auto;
  width: 120px;
}
    .hero-section {
        min-height: 80vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        position: relative;
        overflow: hidden;
    }
    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><polygon fill="rgba(255,255,255,0.05)" points="0,1000 1000,0 1000,1000"/></svg>');
    }
    .hero-title {
        font-size: 3.5rem;
        font-weight: 800;
        margin-bottom: 1rem;
        background: linear-gradient(135deg, #667eea, #f093fb);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    .hero-subtitle {
        font-size: 1.3rem;
        color: var(--text-light);
        margin-bottom: 2rem;
    }
    .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
    }
    .feature-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: var(--radius-xl);
        padding: 2rem;
        text-align: center;
        transition: all var(--transition-normal);
    }
    .feature-card:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-10px) scale(1.05);
    }
    .feature-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
</style>
</head>
<body class="d-flex flex-column">

  <!-- Top Navbar Row 1 -->
  <nav class="navbar navbar-light bg-light nav-row">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">CampusConnect ðŸŽ“</span>
      <div class="d-flex">
        <!-- Add this div right before the authButton in the first navbar row -->
         <div class="position-relative me-3">
        <button class="btn btn-outline-primary position-relative" onclick="viewMessages()">
        <i class="fas fa-bell"></i>
        <span class="message-badge" id="messageCount">0</span>
        </button>
        </div>
        <button id="authButton" class="btn btn-outline-primary" onclick="handleAuth()">Login</button>
      </div>
    </div>
  </nav>

  <!-- Top Navbar Row 2 -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light nav-row" id="mainNavbar" style="top:70px">
    <div class="container-fluid">
      <div class="navbar-nav" id="navLinks">
        <!-- Links will be populated dynamically based on login status -->
      </div>
    </div>
  </nav>

  <!-- Welcome Section -->
  <div class="text-center mt-4">
    <h2 class="fw-bold">Welcome to CampusConnect</h2>
    <p class="text-muted">Your place to buy, sell, and find lost items inside campus.</p>
  </div>

  <!-- Center Cards -->
  <div class="container d-flex justify-content-center align-items-center flex-grow-1">
    <div class="row g-4 text-center">

      <!-- Buy Card -->
      <div class="col-md-4">
        <div class="card h-100">
          <img src="buy.jpg" alt="Buy">
          <div class="card-body">
            <h5 class="card-title fw-bold">Looking something to Buy?</h5>
            <button class="btn btn-primary mt-2" onclick="handleBuyClick()">Buy</button>
          </div>
        </div>
      </div>

      <!-- Sell Card -->
      <div class="col-md-4">
        <div class="card h-100">
          <img src="sell.jpg" alt="Sell">
          <div class="card-body">
            <h5 class="card-title fw-bold">Do you want to sell your Items?</h5>
            <button class="btn btn-success mt-2" onclick="handleSellClick()">Sell</button>
          </div>
        </div>
      </div>

      <!-- Search Card -->
      <div class="col-md-4">
        <div class="card h-100">
          <img src="lost.jpg" alt="Search">
          <div class="card-body">
            <h5 class="card-title fw-bold">Searching for any of your items?</h5>
            <button class="btn btn-warning mt-2" onclick="handleSearchClick()">Search Here</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- About Section -->
  <div class="container mt-5">
    <h3 class="fw-bold text-center">About CampusConnect</h3>
    <p class="text-center mt-3">
      CampusConnect is designed to help students easily buy and sell items within their campus, 
      and also find their lost belongings. Whether you're looking for affordable study materials, 
      selling your used items, or finding lost items, this platform is built exclusively for your campus community.
    </p>
  </div>

  <!-- Custom Feedback Modal -->
<div class="modal fade" id="feedbackModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header" id="feedbackHeader">
        <h5 class="modal-title" id="feedbackTitle">
          <i class="fas fa-info-circle me-2"></i>Notification
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="feedbackMessage">
        <!-- Message will be inserted here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

  <!-- Footer -->
  <footer>
    <hr>
    Â© 2025 CampusConnect | Made by CampusConnect Team
    <div class="social-icons">
      <a href="#"><i class="fab fa-instagram"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-linkedin"></i></a>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>

    // Custom feedback function
function showFeedback(message, type = 'info', autoRedirect = null, redirectUrl = null) {
  const modal = new bootstrap.Modal(document.getElementById('feedbackModal'));
  const header = document.getElementById('feedbackHeader');
  const title = document.getElementById('feedbackTitle');
  const messageEl = document.getElementById('feedbackMessage');
  
  switch(type) {
    case 'success':
      header.className = 'modal-header bg-success text-white';
      title.innerHTML = '<i class="fas fa-check-circle me-2"></i>Success!';
      break;
    case 'error':
      header.className = 'modal-header bg-danger text-white';
      title.innerHTML = '<i class="fas fa-times-circle me-2"></i>Error!';
      break;
    case 'warning':
      header.className = 'modal-header bg-warning text-white';
      title.innerHTML = '<i class="fas fa-exclamation-triangle me-2"></i>Warning!';
      break;
    default:
      header.className = 'modal-header bg-primary text-white';
      title.innerHTML = '<i class="fas fa-info-circle me-2"></i>Information';
  }
  
  messageEl.textContent = message;
  modal.show();
  
  if (autoRedirect && redirectUrl) {
    setTimeout(() => {
      modal.hide();
      window.location.href = redirectUrl;
    }, 2000);
  }
}
    // Check login status and update navbar
    function updateNavbar() {
      const token = localStorage.getItem('token');
      const userRole = localStorage.getItem('userRole');
      const authButton = document.getElementById('authButton');
      const navLinks = document.getElementById('navLinks');
      
      if (token) {
        // User is logged in
        authButton.textContent = 'Sign Out';
        authButton.className = 'btn btn-outline-danger';
        
        let adminLink = '';
        if (userRole === 'admin') {
          adminLink = '<a class="nav-link" href="admin_dashboard.html">Admin Panel</a>';
        }
        
        navLinks.innerHTML = `
          ${adminLink}
          <a class="nav-link" href="index.html">Home</a>
          <a class="nav-link" href="profile.html">View Profile</a>
          <a class="nav-link" href="orders.html">My Orders</a>
          <a class="nav-link" href="feedback.html">Feedback</a>
          <a class="nav-link" href="contact.html">Contact Us</a>
          <a class="nav-link" href="services.html">Services</a>
          <a class="nav-link" href="address.html">Address</a>
        `;
      } else {
        // User is not logged in
        authButton.textContent = 'Login';
        authButton.className = 'btn btn-outline-primary';
        
        navLinks.innerHTML = `
          <a class="nav-link" href="contact.html">Contact Us</a>
          <a class="nav-link" href="services.html">Services</a>
          <a class="nav-link" href="address.html">Address</a>
        `;
      }
    }

    // Handle authentication button click
    function handleAuth() {
      const token = localStorage.getItem('token');
      if (token) {
        // Sign out
        localStorage.removeItem('token');
        localStorage.removeItem('userId');
        localStorage.removeItem('username');
        localStorage.removeItem('userRole');
        updateNavbar();
        window.location.href = 'index.html';
      } else {
        // Go to login
        window.location.href = 'login.html';
      }
    }

// Handle feature clicks with authentication check using feedback modal
function handleBuyClick() {
  if (!localStorage.getItem('token')) {
    showFeedback('Please login first to access Buy features', 'warning', true, 'login.html');
    return;
  }
  window.location.href = 'buy.html';
}

function handleSellClick() {
  if (!localStorage.getItem('token')) {
    showFeedback('Please login first to access Sell features', 'warning', true, 'login.html');
    return;
  }
  window.location.href = 'sell_choose.html';
}

function handleSearchClick() {
  if (!localStorage.getItem('token')) {
    showFeedback('Please login first to access Search features', 'warning', true, 'login.html');
    return;
  }
  window.location.href = 'lost.html';
}
// Load message count for navbar
async function loadMessageCount() {
  try {
    const token = localStorage.getItem('token');
    if (!token) {
      document.getElementById('messageCount').textContent = '0';
      return;
    }

    const response = await fetch('http://localhost:5000/api/messages/unread-count', {
      headers: {
        'Authorization': 'Bearer ' + token
      }
    });
    
    if (response.ok) {
      const data = await response.json();
      document.getElementById('messageCount').textContent = data.count;
    } else {
      document.getElementById('messageCount').textContent = '0';
    }
  } catch (err) {
    console.error('Error loading message count:', err);
    document.getElementById('messageCount').textContent = '0';
  }
}

function viewMessages() {
  const token = localStorage.getItem('token');
  if (!token) {
    showFeedback('Please login first to view messages', 'warning', true, 'login.html');
    return;
  }
  window.location.href = 'messages.html';
}
// Call loadMessageCount when page loads for logged-in users
document.addEventListener('DOMContentLoaded', function() {
  const token = localStorage.getItem('token');
  if (token) {
    loadMessageCount();
  }
});

    // Initialize navbar on page load
    document.addEventListener('DOMContentLoaded', updateNavbar);
  </script>
</body>
</html>